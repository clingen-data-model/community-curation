(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"1Q+X":function(t,e,n){"use strict";var s=n("o0o1"),i=n.n(s);function r(t,e,n,s,i,r,o){try{var a=t[r](o),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(s,i)}var o=function(){var t,e=(t=i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=JSON.parse(localStorage.getItem("baseline-activities"))){t.next=4;break}return t.next=4,window.axios.get("/api/curation-activities?only_baseline=1").then((function(t){return e=t.data.data,localStorage.setItem("baseline-activities",JSON.stringify(e)),e}));case 4:return t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var o=t.apply(e,n);function a(t){r(o,s,i,a,c,"next",t)}function c(t){r(o,s,i,a,c,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}();e.a=o},"8w6g":function(t,e,n){"use strict";function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n={id:null,topic:{},topic_id:null,topic_type:"App\\CurationActivity",starts_at:null,ends_at:null,url:null,invite_message:"",notes:"",created_at:null,updated_at:null};for(var s in this.attributes=i(i({},n),e),this.dateFields=["starts_at","ends_at","created_at","updated_at"],this.appends=["duration"],this.attributes)this.attributes.hasOwnProperty(s)&&(this[s]=this.hydrateAttribute(s,e[s]))}var e,n,s;return e=t,(n=[{key:"clone",value:function(){return new t(this.attributes)}},{key:"getDuration",value:function(){return this.duration}},{key:"exportAttributes",value:function(){return i(i({},this.attributes),{duration:this.duration})}},{key:"hydrateAttribute",value:function(t,e){if(this.dateFields.includes(t)){var n=window.moment();return null!==e&&(n=window.moment(e)),n}return e}},{key:"duration",get:function(){return this.ends_at.diff(this.starts_at,"minutes")},set:function(t){this.ends_at=this.starts_at.clone().add(t,"minutes")}},{key:"started",get:function(){return this.starts_at.isBefore(moment())}},{key:"ended",get:function(){return this.ends_at.isBefore(moment())}}])&&a(e.prototype,n),s&&a(e,s),t}();e.a=c},"KHd+":function(t,e,n){"use strict";function s(t,e,n,s,i,r,o,a){var c,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=n,u._compiled=!0),s&&(u.functional=!0),r&&(u._scopeId="data-v-"+r),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=c):i&&(c=a?function(){i.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(u.functional){u._injectStyles=c;var l=u.render;u.render=function(t,e){return c.call(e),l(t,e)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:u}}n.d(e,"a",(function(){return s}))},U6kH:function(t,e,n){"use strict";n.r(e);var s=n("o0o1"),i=n.n(s),r=n("1Iqk"),o=(n("wd/R"),n("8w6g"));function a(t,e,n,s,i,r,o){try{var a=t[r](o),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(s,i)}var c=function(){var t,e=(t=i.a.mark((function t(e){var n,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/api/training-sessions?"+Object(r.a)(e),t.next=3,window.axios(n);case 3:return s=t.sent,t.abrupt("return",s.data.data.map((function(t){return new o.a(t)})));case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var r=t.apply(e,n);function o(t){a(r,s,i,o,c,"next",t)}function c(t){a(r,s,i,o,c,"throw",t)}o(void 0)}))});return function(t){return e.apply(this,arguments)}}(),u=function(t){return window.axios.delete("api/training-sessions/"+t)},l=function(t){return t.starts_at=moment(t.starts_at).toISOString(),t.ends_at=moment(t.ends_at).toISOString(),window.axios.post("api/training-sessions",t)},d=n("WL/6");function f(t,e,n,s,i,r,o){try{var a=t[r](o),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(s,i)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(s,i){var r=t.apply(e,n);function o(t){f(r,s,i,o,a,"next",t)}function a(t){f(r,s,i,o,a,"throw",t)}o(void 0)}))}}var v={components:{TrainingSessionForm:n("cfPs").a},data:function(){var t=this;return{selectedTab:this.getSelectedTab(),sessions:[],pastSessions:[],fields:[{key:"topic.name",label:"Topic",sortable:!0},{key:"starts_at",label:"Date & Time",sortable:"true",formatter:function(e,n,s){return t.$options.filters.formatDate(e,"YYYY-MM-DD HH:mm")+" EST"},sortByFormatted:!0},{key:"id",label:"",sortable:!1}],sortBy:"starts_at",sortDesc:!1,pastSortBy:"starts_at",pastSortDesc:!0,showCreate:!1,showEdit:!1,currentSession:{},errors:{}}},computed:{allSessions:function(){return this.sessions.concat(this.pastSessions)}},watch:{selectedTab:function(t,e){t!=e&&localStorage.setItem("training-list-tab",this.selectedTab)}},methods:{navigateToTrainingSession:function(t){window.location="/training-sessions/"+t.id},edit:function(t){this.currentSession=this.allSessions.find((function(e){return e.id==t})),this.showEdit=!0},destroy:function(t){var e=this;confirm("You are about to delete this training session.  This cannot be undone and the attendees will be notified of its cancellation.  Do you want to continue?")&&u(t).then((function(t){e.getSessions(),e.getPastSessions()}))},getSessions:function(){var t=this;return p(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:t.sessions=e.sent;case 3:case"end":return e.stop()}}),e)})))()},getPastSessions:function(){var t=this;return p(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c({scopes:["past"]});case 2:t.pastSessions=e.sent;case 3:case"end":return e.stop()}}),e)})))()},getSelectedTab:function(){var t=localStorage.getItem("training-list-tab");return null!==t?parseInt(t):0},createSession:function(t){var e=this;this.errors={},l(t).then((function(t){var n=new o.a(t.data.data);e.sessions.push(n),e.currentSession={},e.showCreate=!1})).catch((function(t){e.errors=t.response.data.errors}))},cancelCreate:function(){this.errors={},this.showCreate=!1},updateSession:function(t){var e=this;this.errors={},Object(d.a)(this.currentSession.id,t).then((function(t){e.currentSession={},e.showEdit=!1,e.getSessions(),e.getPastSessions()})).catch((function(t){e.errors=t.response.data.errors}))},cancelUpdate:function(){this.errors={},this.currentSession={},this.showEdit=!1}},mounted:function(){var t=this;this.getSessions(),this.getPastSessions(),window.addEventListener("popstate",(function(e){t.selectedTab=e.tabIdx}))}},m=n("KHd+"),h=Object(m.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("button",{staticClass:"float-right btn btn-sm btn-primary",on:{click:function(e){t.showCreate=!0}}},[t._v("Add new")]),t._v(" "),n("h3",{staticClass:"m-0"},[t._v("\n                Training Sessions\n            ")])]),t._v(" "),n("div",{staticClass:"card-body"},[n("b-tabs",{attrs:{pills:""},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[n("b-tab",{scopedSlots:t._u([{key:"title",fn:function(){return[t._v("\n                        Upcoming "),n("b-badge",{staticClass:"ml-1",attrs:{variant:"light"}},[t._v(t._s(t.sessions.length))])]},proxy:!0}])},[t._v(" "),n("b-table",{staticClass:"mt-4 cursor-pointer",attrs:{fields:t.fields,items:t.sessions,"sort-by":t.sortBy,"sort-desc":t.sortDesc},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e},"row-clicked":t.navigateToTrainingSession},scopedSlots:t._u([{key:"cell(id)",fn:function(e){var s=e.value;return[n("div",{staticClass:"text-right"},[n("a",{staticClass:"btn border btn-light btn-xs",attrs:{href:"/training-sessions/"+s}},[t._v("View")]),t._v(" "),n("button",{staticClass:"btn border btn-light btn-xs",on:{click:function(e){return t.edit(s)}}},[t._v("Edit")]),t._v(" "),n("button",{staticClass:"btn border btn-light btn-xs",on:{click:function(e){return t.destroy(s)}}},[t._v("Delete")])])]}},{key:"cell(starts_at)",fn:function(e){var n=e.item;return[t._v("\n                            "+t._s(n.starts_at.format("MMMM D, YYYY - h:mm a"))+"\n                        ")]}}])})],1),t._v(" "),n("b-tab",{attrs:{title:"Past"},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("\n                        Past "),n("b-badge",{staticClass:"ml-1",attrs:{variant:"light"}},[t._v(t._s(t.pastSessions.length))])]},proxy:!0}])},[t._v(" "),n("b-table",{staticClass:"mt-4",attrs:{fields:t.fields,items:t.pastSessions,"sort-by":t.pastSortBy,"sort-desc":t.pastSortDesc,hover:""},on:{"update:sortBy":function(e){t.pastSortBy=e},"update:sort-by":function(e){t.pastSortBy=e},"update:sortDesc":function(e){t.pastSortDesc=e},"update:sort-desc":function(e){t.pastSortDesc=e},"row-clicked":t.navigateToTrainingSession},scopedSlots:t._u([{key:"cell(starts_at)",fn:function(e){var n=e.item;return[t._v("\n                            "+t._s(n.starts_at.format("MMMM D, YYYY - h:mm a"))+"\n                        ")]}},{key:"cell(id)",fn:function(e){var s=e.value;return[n("div",{staticClass:"text-right"},[n("a",{staticClass:"btn border btn-light btn-xs",attrs:{href:"/training-sessions/"+s}},[t._v("View")]),t._v(" "),n("button",{staticClass:"btn border btn-light btn-xs",on:{click:function(e){return t.edit(s)}}},[t._v("Edit")]),t._v(" "),n("button",{staticClass:"btn border btn-light btn-xs",on:{click:function(e){return t.destroy(s)}}},[t._v("Delete")])])]}}])})],1)],1)],1)]),t._v(" "),n("b-modal",{attrs:{size:"lg","hide-footer":""},model:{value:t.showCreate,callback:function(e){t.showCreate=e},expression:"showCreate"}},[n("training-session-form",{attrs:{errors:t.errors},on:{saved:t.createSession,canceled:t.cancelCreate}})],1),t._v(" "),n("b-modal",{attrs:{size:"lg","hide-footer":""},model:{value:t.showEdit,callback:function(e){t.showEdit=e},expression:"showEdit"}},[n("training-session-form",{attrs:{"training-session":t.currentSession,errors:t.errors},on:{saved:t.updateSession,canceled:t.cancelUpdate}})],1)],1)}),[],!1,null,null,null);e.default=h.exports},"WL/6":function(t,e,n){"use strict";var s=n("wd/R"),i=n.n(s);e.a=function(t,e){return console.info("updateTrainingSession",e),e.starts_at=i()(e.starts_at).toISOString(),e.ends_at=i()(e.ends_at).toISOString(),window.axios.put("/api/training-sessions/"+t,e)}},cfPs:function(t,e,n){"use strict";var s=n("wd/R"),i=n.n(s),r=n("8w6g");n("LvDl");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a={props:{value:{required:!0}},data:function(){return{}},computed:{stringValue:function(){return this.convertToTimeString(this.value)}},methods:{emitInput:function(t){this.$emit("input",t.target.value)},convertToTimeString:function(t){if("string"==typeof t)return t;if("object"==o(t)){if(t instanceof Date)return"".concat(t.getHour(),":").concat(t.getMinue()," ");if(t instanceof moment)return t.format("HH:mm A")}if("number"==typeof t)return this.convertToDateString(moment(t));if(void 0===t)return t;throw Error("Prop 'value' was of unknown type.")}}},c=n("KHd+");function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l={props:{value:{required:!0}},computed:{stringValue:function(){return this.convertToDateString(this.value)}},methods:{emitInput:function(t){console.log(t.target.value),this.$emit("input",t.target.value)},convertToDateString:function(t){if(console.log(t),"string"==typeof t)return t;if("object"==u(t)){if(t instanceof Date)return"".concat(t.getFullYear(),"-").concat(t.getMonth(),"-").concat(t.getDate());if(t instanceof i.a)return t.format("YYYY-MM-DD")}if("number"==typeof t)return this.convertToDateString(i()(t));if(void 0===t)return t;throw Error("Prop 'value' was of unknown type.")}}},d={components:{TimePicker:Object(c.a)(a,(function(){var t=this.$createElement;return(this._self._c||t)("input",{staticClass:"form-control",attrs:{type:"time"},domProps:{value:this.stringValue},on:{blur:this.emitInput}})}),[],!1,null,null,null).exports,DatePicker:Object(c.a)(l,(function(){var t=this.$createElement;return(this._self._c||t)("input",{staticClass:"form-control",attrs:{type:"date"},domProps:{value:this.stringValue},on:{blur:this.emitInput}})}),[],!1,null,null,null).exports},props:{value:{required:!0}},data:function(){return{dateValue:null,timeValue:null}},computed:{currentTimezone:function(){return"".concat(i()().tz(Intl.DateTimeFormat().resolvedOptions().timeZone).format("z"))}},watch:{value:{immediate:!0,handler:function(t,e){this.syncDateAndTime()}},dateValue:function(){this.handleChange()},timeValue:function(){this.handleChange()}},methods:{handleChange:function(){var t=i()(this.dateValue+" "+this.timeValue,"YYYY-MM-DD HH:mm:ss A");console.info("handleChange timeValue:",this.timeValue),console.info("handleChange",t),this.$emit("input",t),this.$emit("change")},syncDateAndTime:function(){this.dateValue=i()(this.value).format("YYYY-MM-DD"),this.timeValue=i()(this.value).format("HH:mm:ss")}}},f=Object(c.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-input-group",{attrs:{append:t.currentTimezone}},[n("date-picker",{staticClass:"form-control",model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}}),t._v(" "),n("time-picker",{staticClass:"form-control",model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1)],1)}),[],!1,null,null,null).exports,p=n("IAky"),v=n("1Q+X"),m={components:{DateTime:f},props:{trainingSession:{type:Object,required:!1,default:function(){return new r.a}},errors:{type:Object,default:function(){}}},data:function(){return{topics:[{}],newSessionData:{},duration:60,durationMin:15,durationMax:240,durationErrors:[],newInviteMessage:""}},computed:{currentTimezone:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone}},methods:{updateEndsAt:function(){this.newSessionData.starts_at&&this.duration&&(this.newSessionData.ends_at=this.newSessionData.starts_at.clone().add(this.duration,"minutes"))},initNewSession:function(){null!==this.trainingSession&&this.syncTrainingSession()},syncTrainingSession:function(){this.newSessionData=this.trainingSession.attributes,this.duration=this.trainingSession.duration?this.trainingSession.duration:60},durationIsValid:function(){return!(this.duration<this.durationMin||this.duration>this.durationMax)||(this.durationErrors=["The session must be at least 15 minutes and no more than 240 minutes."],!1)},loadCurationActivities:function(){var t=this;this.topics=[],Object(p.a)().then((function(e){e.forEach((function(e){t.topics.push(e)}))})),Object(v.a)().then((function(e){e.forEach((function(e){t.topics.push(e)}))}))}},mounted:function(){this.initNewSession(),this.loadCurationActivities()}},h=Object(c.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"topic"}},[t._v("Topic *")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.newSessionData.topic_id,expression:"newSessionData.topic_id"}],staticClass:"form-control",attrs:{id:"topic"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.newSessionData,"topic_id",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""}},[t._v("Select…")]),t._v(" "),t._l(t.topics,(function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),t._v(" "),n("validation-error",{attrs:{errors:t.errors.topic_id}})],1)]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"start-date-field"}},[t._v("\n            Start Date & time*\n        ")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("date-time",{staticClass:"form-inline",on:{change:t.updateEndsAt},model:{value:t.newSessionData.starts_at,callback:function(e){t.$set(t.newSessionData,"starts_at",e)},expression:"newSessionData.starts_at"}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.starts_at}})],1)]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"duration-field"}},[t._v("Duration (in minutes)*")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.duration,expression:"duration"}],staticClass:"form-control",attrs:{type:"text",id:"duration-field"},domProps:{value:t.duration},on:{change:t.updateEndsAt,input:function(e){e.target.composing||(t.duration=e.target.value)}}}),t._v(" "),n("small",{staticClass:"text-muted"},[t._v("Ends "+t._s(t._f("formatDate")(this.newSessionData.ends_at,"YYYY-MM-DD hh:mm A")))]),t._v(" "),n("validation-error",{attrs:{errors:t.durationErrors}})],1)]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"url-field"}},[t._v("URL*")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newSessionData.url,expression:"newSessionData.url"}],staticClass:"form-control w-100",attrs:{type:"text",id:"url-field",placeholder:"https://zoom.com"},domProps:{value:t.newSessionData.url},on:{input:function(e){e.target.composing||t.$set(t.newSessionData,"url",e.target.value)}}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.url}})],1)]),t._v(" "),n("div",{staticClass:"form-group row align-items-start"},[n("label",{staticClass:"col-sm-3",attrs:{for:"invie-message-field"}},[t._v("Inivite Message")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("rich-text",{attrs:{id:"message-body"},model:{value:t.newSessionData.invite_message,callback:function(e){t.$set(t.newSessionData,"invite_message",e)},expression:"newSessionData.invite_message"}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.invite_message}})],1)]),t._v(" "),n("div",{staticClass:"form-group row align-items-start"},[n("label",{staticClass:"col-sm-3",attrs:{for:"notes-field"}},[t._v("Notes")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newSessionData.notes,expression:"newSessionData.notes"}],staticClass:"form-control w-100",attrs:{id:"nots-field",rows:"5"},domProps:{value:t.newSessionData.notes},on:{input:function(e){e.target.composing||t.$set(t.newSessionData,"notes",e.target.value)}}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.notes}})],1)]),t._v(" "),n("div",[n("button",{staticClass:"btn btn-default border",on:{click:function(e){return t.$emit("canceled")}}},[t._v("\n            Cancel\n        ")]),t._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.$emit("saved",t.newSessionData)}}},[t._v("\n            Save\n        ")])])])}),[],!1,null,null,null);e.a=h.exports}}]);
//# sourceMappingURL=training-session-list.02f096b273e1d72c4844.js.map