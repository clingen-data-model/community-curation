(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"1Q+X":function(t,e,n){"use strict";var s=n("o0o1"),i=n.n(s);function a(t,e,n,s,i,a,r){try{var o=t[a](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,i)}var r=function(){var t,e=(t=i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=JSON.parse(localStorage.getItem("baseline-activities"))){t.next=4;break}return t.next=4,window.axios.get("/api/curation-activities?only_baseline=1").then((function(t){return e=t.data.data,localStorage.setItem("baseline-activities",JSON.stringify(e)),e}));case 4:return t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var r=t.apply(e,n);function o(t){a(r,s,i,o,l,"next",t)}function l(t){a(r,s,i,o,l,"throw",t)}o(void 0)}))});return function(){return e.apply(this,arguments)}}();e.a=r},"8w6g":function(t,e,n){"use strict";function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var n={id:null,topic:{},topic_id:null,topic_type:"App\\CurationActivity",starts_at:null,ends_at:null,url:null,invite_message:"",notes:"",created_at:null,updated_at:null};for(var s in this.attributes=i(i({},n),e),this.dateFields=["starts_at","ends_at","created_at","updated_at"],this.appends=["duration"],this.attributes)this.attributes.hasOwnProperty(s)&&(this[s]=this.hydrateAttribute(s,e[s]))}var e,n,s;return e=t,(n=[{key:"clone",value:function(){return new t(this.attributes)}},{key:"getDuration",value:function(){return this.duration}},{key:"exportAttributes",value:function(){return i(i({},this.attributes),{duration:this.duration})}},{key:"hydrateAttribute",value:function(t,e){if(this.dateFields.includes(t)){var n=window.moment();return null!==e&&(n=window.moment(e)),n}return e}},{key:"duration",get:function(){return this.ends_at.diff(this.starts_at,"minutes")},set:function(t){this.ends_at=this.starts_at.clone().add(t,"minutes")}},{key:"started",get:function(){return this.starts_at.isBefore(moment())}},{key:"ended",get:function(){return this.ends_at.isBefore(moment())}}])&&o(e.prototype,n),s&&o(e,s),t}();e.a=l},"KHd+":function(t,e,n){"use strict";function s(t,e,n,s,i,a,r,o){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),s&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),r?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):i&&(l=o?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:c}}n.d(e,"a",(function(){return s}))},QuOj:function(t,e,n){"use strict";n.r(e);var s=n("o0o1"),i=n.n(s),a=n("WL/6"),r=n("cfPs"),o=n("wd/R"),l=n.n(o),c=function(t,e){return window.axios.post("/api/training-sessions/"+t.id+"/attendees",{attendee_ids:e.map((function(t){return t.id}))})},u=n("pQJT");function d(t,e,n,s,i,a,r){try{var o=t[a](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,i)}var v=function(){var t,e=(t=i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.axios.get("/api/training-sessions/"+e.id+"/attendees").then((function(t){return t.data.data})).catch((function(t){t.response?alert(t.response.statusText):alert("There was a problem getting attendees for training session ")}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){d(a,s,i,r,o,"next",t)}function o(t){d(a,s,i,r,o,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}();function m(t,e,n,s,i,a,r){try{var o=t[a](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,i)}var f=function(){var t,e=(t=i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.axios.get("/api/training-sessions/"+e.id+"/trainable-volunteers").then((function(t){return t.data.data})).catch((function(t){alert(t.response.statusText)}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){m(a,s,i,r,o,"next",t)}function o(t){m(a,s,i,r,o,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}(),p=n("L2JU");function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _={props:{trainingSession:{required:!0,type:Object},attendees:{required:!0,type:Array}},data:function(){return{subject:"",emailContent:"",fromEmail:this.$store.state.configs.mailFrom.address}},methods:g(g({},Object(p.d)("messages",["addInfo"])),{},{sendEmail:function(){var t=this;""!=this.emailContent?(this.$emit("sending"),window.axios.post("/api/training-sessions/"+this.trainingSession.id+"/attendees/email",{from:this.fromEmail,subject:this.subject,body:this.emailContent}).then((function(e){t.addInfo("Email sent"),t.initData(),t.$emit("sent")}))):alert("You must include a message to send to attendees.")},cancelEmail:function(){this.initData(),this.$emit("canceled")},initData:function(){this.subject="",this.emailContent=""}})},w=n("KHd+");function y(t,e,n,s,i,a,r){try{var o=t[a](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,i)}function C(t){return function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){y(a,s,i,r,o,"next",t)}function o(t){y(a,s,i,r,o,"throw",t)}r(void 0)}))}}function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O={components:{AttendeeEmailForm:Object(w.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border p-3 rounded"},[n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-lg-1"},[t._v("To:")]),t._v(" "),n("small",{staticClass:"col-lg-11"},[t._v(t._s(t.attendees.map((function(t){return t.first_name+" "+t.last_name})).join(", ")))])]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-lg-1",attrs:{for:"from"}},[t._v("From:")]),t._v(" "),n("div",{staticClass:"col-lg-6"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.fromEmail,expression:"fromEmail"}],staticClass:"form-control",attrs:{id:"from"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.fromEmail=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:t.$store.state.configs.mailFrom.address}},[t._v(t._s(t.$store.state.configs.mailFrom.address))]),t._v(" "),n("option",{domProps:{value:t.$store.state.user.email}},[t._v(t._s(t.$store.state.user.email))])])])]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-lg-1",attrs:{for:"subject"}},[t._v("Subject:")]),t._v(" "),n("div",{staticClass:"col-lg-8"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.subject,expression:"subject"}],staticClass:"form-control w-50",attrs:{type:"text",id:"subject"},domProps:{value:t.subject},on:{input:function(e){e.target.composing||(t.subject=e.target.value)}}})])]),t._v(" "),n("rich-text",{attrs:{id:"message-body"},model:{value:t.emailContent,callback:function(e){t.emailContent=e},expression:"emailContent"}}),t._v(" "),n("div",{staticClass:"mt-3"},[n("button",{staticClass:"btn btn-sm btn-default border",on:{click:t.cancelEmail}},[t._v("Cancel")]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-primary",on:{click:t.sendEmail}},[t._v("Send Email")])])],1)}),[],!1,null,null,null).exports},props:{trainingSession:{required:!0,type:Object}},data:function(){var t=this;return{test:!1,attendees:[],selectedVolunteers:[],fields:[{key:"first_name",label:"First Name",sortable:!0},{key:"last_name",label:"Last Name",sortable:!0},{key:"assignments[0].date_assigned",label:"Date Assigned",sortable:!0,formatter:function(e,n,s){if(s.assignments[0])return t.$root.$options.filters.formatDate(s.assignments[0].date_assigned,"YYYY-MM-DD");console.info("missing assignments",s)}}],trainableVolunteers:[],loadingAttendees:!1,loadingVolunteers:!1,selectAll:!1,showEmailForm:!1,inviting:!1,currentDateTime:l()(),trainableFilter:null,showInactiveTrainables:!1}},watch:{trainingSession:function(){this.getAttendees(),this.getTrainableVolunteers()}},computed:{sessionStarted:function(){return this.trainingSession.starts_at.isBefore(this.currentDateTime)},hasAttendees:function(){return this.attendees.length>0},inviteFields:function(){return this.fields.concat([{key:"id",label:""}])},attendeeFields:function(){return this.fields.concat([{key:"id",label:""}])},canInvite:function(){return this.trainableVolunteers.length>0&&this.selectedVolunteers.length>0&&!this.inviting},inviteButtonText:function(){return this.inviting?"Busy...":"Invite Selected"},filteredTrainable:function(){var t=this,e=this.trainableVolunteers;return this.showInactiveTrainables||(e=e.filter((function(t){return-1==["unresponsive","declined","retired"].indexOf(t.volunteer_status.name)}))),null===this.trainableFilter||""===this.trainableFilter?e:e.filter((function(e){return e.first_name.toLowerCase().includes(t.trainableFilter.toLowerCase())||e.last_name.toLowerCase().includes(t.trainableFilter.toLowerCase())}))}},methods:k(k({},Object(p.d)("messages",["addInfo"])),{},{toggleAll:function(){this.selectAll?this.selectedVolunteers=this.trainableVolunteers:this.selectedVolunteers=[]},inviteSelected:function(){var t=this,e=JSON.parse(JSON.stringify(this.attendees)),n=JSON.parse(JSON.stringify(this.trainableVolunteers));this.inviting=!0,c(this.trainingSession,this.selectedVolunteers).then((function(e){t.attendees=e.data.data,t.addInfo("Invited "+t.selectedVolunteers.length+" volunteer"+(t.selectedVolunteers.length>1?"s":"")+" to the training session"),t.selectedVolunteers=[],t.getTrainableVolunteers(),t.selectAll=!1})).catch((function(s){alert("There was a problem inviting attendees: "+s.response.statusText+"."),t.attendees=e,t.trainableVolunteers=n,t.selectAll=!1})).then((function(){return t.inviting=!1}))},getAttendees:function(){var t=this;return C(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingAttendees=!0,e.next=3,v(t.trainingSession);case 3:t.attendees=e.sent,t.loadingAttendees=!1;case 5:case"end":return e.stop()}}),e)})))()},getTrainableVolunteers:function(){var t=this;return C(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingVolunteers=!0,e.next=3,f(t.trainingSession);case 3:t.trainableVolunteers=e.sent,t.trainableVolunteers=t.trainableVolunteers.map((function(t){return["unresponsive","declined","retired"].indexOf(t.volunteer_status.name)>-1&&(t._rowVariant="muted"),t})),t.loadingVolunteers=!1;case 6:case"end":return e.stop()}}),e)})))()},handleInviteRowClick:function(t,e,n){var s=this.selectedVolunteers.indexOf(t);s>-1?this.selectedVolunteers.splice(s,1):this.selectedVolunteers.push(t)},markTrainingComplete:function(t){var e=this;this.$set(t,"training_complete",!0),Object(u.a)(t.assignments[0].user_aptitudes[0].id,l()()).then((function(n){e.addInfo("Training marked completed for "+t.first_name+" "+t.last_name)}))}}),mounted:function(){var t=this;setInterval((function(){t.currentDateTime=l()()}),1e3)}},D=(n("kf0Z"),Object(w.a)(O,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",[n("header",[n("button",{staticClass:"btn btn-light border btn-xs float-right",on:{click:function(e){t.showEmailForm=!t.showEmailForm}}},[t._v("\n                "+t._s(t.showEmailForm?"Cancel email":"Email attendees")+"\n            ")]),t._v(" "),n("h4",[t._v("\n                Attendees "),n("small",[t._v("("+t._s(t.attendees.length)+")")]),t._v(" "),n("button",{staticClass:"btn btn-default material-icons",class:{rotate:t.loadingAttendees},on:{click:t.getAttendees}},[t._v("cached")])])]),t._v(" "),n("transition",{attrs:{name:"slide-fade"}},[n("attendee-email-form",{directives:[{name:"show",rawName:"v-show",value:t.showEmailForm,expression:"showEmailForm"}],staticClass:"mb-2",attrs:{trainingSession:t.trainingSession,attendees:t.attendees},on:{sending:function(e){t.showEmailForm=!1},sent:function(e){t.showEmailForm=!1},canceled:function(e){t.showEmailForm=!1}}})],1),t._v(" "),n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEmailForm,expression:"!showEmailForm"}]},[t.hasAttendees?n("div",[n("b-table",{staticClass:"border-bottom",attrs:{fields:t.attendeeFields,items:t.attendees,small:"","sticky-header":"305px"},scopedSlots:t._u([{key:"cell(first_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.first_name))])]}},{key:"cell(last_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.last_name))])]}},{key:"cell(id)",fn:function(e){var s=e.item;return[t.sessionStarted&&!s.training_complete?n("button",{staticClass:"btn btn-default btn-xs border",on:{click:function(e){return t.markTrainingComplete(s)}}},[t._v("\n                                Mark Training Complete\n                            ")]):t._e(),t._v(" "),n("small",{directives:[{name:"show",rawName:"v-show",value:s.training_complete,expression:"item.training_complete"}],staticClass:"text-muted"},[t._v("Training Complete")])]}}],null,!1,966640674)})],1):n("div",{staticClass:"alert alert-light border"},[t.loadingAttendees?n("span",[t._v("Loading...")]):n("span",[t._v("No volunteers have been invited to attend.")])])])])],1),t._v(" "),n("section",{staticClass:"mt-5"},[n("header",{staticClass:"clearfix"},[n("button",{staticClass:"btn btn-sm btn-primary float-right",attrs:{disabled:!t.canInvite},on:{click:t.inviteSelected}},[t._v(t._s(t.inviteButtonText))]),t._v(" "),n("div",{staticClass:"float-right mr-2 mb-2 pr-2 border-right"},[n("b-form-input",{staticClass:"form-control form-control-sm mr-1",attrs:{type:"text",placeholder:"search first or last",debounce:"250"},model:{value:t.trainableFilter,callback:function(e){t.trainableFilter=e},expression:"trainableFilter"}}),t._v(" "),n("button",{staticClass:"btn btn-xs btn-default",on:{click:function(e){t.showInactiveTrainables=!t.showInactiveTrainables}}},[t._v("\n                    "+t._s(t.showInactiveTrainables?"Hide":"Show")+" inactive volunteers\n                ")])],1),t._v(" "),n("h5",[t._v("\n                "+t._s(t.showInactiveTrainables?"All":"Active")+" volunteers who need "+t._s(t.trainingSession.topic.name)+" training \n                "),n("small",[t._v("("+t._s(t.filteredTrainable.length)+")")]),t._v(" "),n("button",{staticClass:"btn btn-default material-icons",class:{rotate:t.loadingVolunteers},on:{click:t.getTrainableVolunteers}},[t._v("cached")])])]),t._v(" "),t.trainableVolunteers.length>0?n("b-table",{staticClass:"border-bottom overflow-auto",attrs:{fields:t.inviteFields,items:t.filteredTrainable,"sort-by":"assignments[0].date_assigned",small:"","no-border-collapse":""},on:{"row-clicked":t.handleInviteRowClick},scopedSlots:t._u([{key:"cell(first_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.first_name))])]}},{key:"cell(last_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.last_name))])]}},{key:"cell(id)",fn:function(e){return[n("div",{staticClass:"text-center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedVolunteers,expression:"selectedVolunteers"}],attrs:{type:"checkbox"},domProps:{value:e.item,checked:Array.isArray(t.selectedVolunteers)?t._i(t.selectedVolunteers,e.item)>-1:t.selectedVolunteers},on:{change:function(n){var s=t.selectedVolunteers,i=n.target,a=!!i.checked;if(Array.isArray(s)){var r=e.item,o=t._i(s,r);i.checked?o<0&&(t.selectedVolunteers=s.concat([r])):o>-1&&(t.selectedVolunteers=s.slice(0,o).concat(s.slice(o+1)))}else t.selectedVolunteers=a}}})])]}},{key:"head(id)",fn:function(e){return[n("div",{staticClass:"text-center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectAll,expression:"selectAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.selectAll)?t._i(t.selectAll,null)>-1:t.selectAll},on:{change:[function(e){var n=t.selectAll,s=e.target,i=!!s.checked;if(Array.isArray(n)){var a=t._i(n,null);s.checked?a<0&&(t.selectAll=n.concat([null])):a>-1&&(t.selectAll=n.slice(0,a).concat(n.slice(a+1)))}else t.selectAll=i},t.toggleAll]}})])]}}],null,!1,1517806451)}):n("div",{staticClass:"alert alert-light border mt-2 mb-2"},[t.loadingVolunteers?n("span",[t._v("Loading...")]):n("span",[t._v("There are no more volunteers who need this training at this time.")])]),t._v(" "),n("footer",{staticClass:"mt-1"},[n("button",{staticClass:"btn btn-sm btn-primary float-right",attrs:{disabled:!t.canInvite},on:{click:t.inviteSelected}},[t._v(t._s(t.inviteButtonText))])])],1)])}),[],!1,null,null,null).exports),j={props:{trainingSession:{required:!0,type:Object}},data:function(){return{showPreviewModal:!1,previewMarkup:null}},computed:{},methods:{showPreview:function(){var t=this;this.showPreviewModal=!0,window.axios.get("/api/training-sessions/"+this.trainingSession.id+"/invite-preview").then((function(e){return t.previewMarkup=e.data}))}}},T=Object(w.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("button",{staticClass:"btn btn-light btn-sm border",on:{click:t.showPreview}},[t._v("Preview invite email")]),t._v(" "),n("b-modal",{attrs:{title:"Invite Preview","hide-footer":""},model:{value:t.showPreviewModal,callback:function(e){t.showPreviewModal=e},expression:"showPreviewModal"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.previewMarkup,expression:"!previewMarkup"}]},[t._v("\n            Loading the preview...\n        ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.previewMarkup,expression:"previewMarkup"}],domProps:{innerHTML:t._s(t.previewMarkup)}})])],1)}),[],!1,null,null,null).exports,E=n("8w6g");function P(t,e,n,s,i,a,r){try{var o=t[a](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,i)}var A={components:{TrainingSessionForm:r.a,AttendeesManager:D,InviteEmailPreview:T},props:{id:{required:!0,type:Number}},data:function(){return{trainingSession:{topic:{}},showEdit:!1,errors:{},show404:!1,showCalendarHelp:!1,showEmailPreview:!1,started:!1,ended:!1,timestamp:(new Date).getTime()}},computed:{duration:function(){if(!this.trainingSession.starts_at||!this.trainingSession.ends_at)return"";var t=this.trainingSession.ends_at.diff(this.trainingSession.starts_at,"minutes");if(t>60){var e=Math.floor(t/60),n=t%60,s=[e];return s.push(e>1?"hours":"hour"),s.push(n),s.push(n>1?"minutes":"minute"),s.join(" ")}return"".concat(t," minutes")}},methods:{updateSession:function(t){var e=this;this.errors={},Object(a.a)(this.trainingSession.id,t).then((function(t){e.showEdit=!1;var n=new E.a(t.data.data);n.starts_at=l()(n.starts_at),n.ends_at=l()(n.ends_at),e.trainingSession=n})).catch((function(t){t.response&&422==t.response.status&&(e.errors=t.response.data.errors),console.error(t)}))},cancelUpdate:function(){this.errors={},this.currentSession={},this.showEdit=!1},addToCalendar:function(){alert("add to calendar")},getTrainingSession:function(){var t,e=this;return(t=i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.show404=!1,t.next=3,window.axios.get("/api/training-sessions/"+e.id).then((function(t){return new E.a(t.data.data)})).catch((function(t){t.response&&404==t.response.status?e.show404=!0:new Error(t)}));case 3:e.trainingSession=t.sent,setInterval((function(){e.started=e.trainingSession.started,e.ended=e.trainingSession.ended,e.timestamp=(new Date).getTime()}),1e3);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){P(a,s,i,r,o,"next",t)}function o(t){P(a,s,i,r,o,"throw",t)}r(void 0)}))})()}},mounted:function(){this.getTrainingSession()}},V=Object(w.a)(A,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("div",{staticClass:"float-right"},[n("b-dropdown",{attrs:{size:"sm",text:"Add to Calendar",variant:"primary"}},[t._l(t.trainingSession.calendar_links,(function(e,s){return n("b-dropdown-item",{key:s,attrs:{href:e,target:"calendar-link"}},[t._v(t._s(s))])})),t._v(" "),n("b-dropdown-divider"),t._v(" "),n("b-dropdown-item",{on:{click:function(e){t.showCalendarHelp=!0}}},[n("small",[t._v("Learn More")])])],2),t._v(" "),n("button",{staticClass:"btn btn-sm btn-primary",on:{click:function(e){t.showEdit=!0}}},[t._v("Edit")])],1),t._v(" "),n("h3",{staticClass:"m-0"},[n("a",{attrs:{href:"/training-sessions"}},[t._v("Training Sessions")]),t._v("\n                -\n                "+t._s(t.trainingSession.topic.name)+"\n                on\n                "+t._s(t._f("formatDate")(t.trainingSession.starts_at,"YYYY-MM-DD \\at h:mm a"))+"\n            ")])]),t._v(" "),n("div",{staticClass:"card-body"},[t.trainingSession.started&&!t.trainingSession.ended?n("div",{key:t.timestamp,staticClass:"alert alert-success mt-0 mb-2"},[t._v("This session has started.")]):t._e(),t._v(" "),t.trainingSession.ended?n("div",{key:t.timestamp+1,staticClass:"alert alert-info mt-0 mb-2"},[t._v("This session has already happened.")]):t._e(),t._v(" "),t.show404?n("div",{staticClass:"alert alert-warning"},[t._v("\n                The session you're looking for could not be found.\n            ")]):t._e(),t._v(" "),n("section",{attrs:{id:"session-info"}},[n("h4",[t._v("Session Info")]),t._v(" "),n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("URL")])]),t._v(" "),n("column",{staticClass:"col-md-9"},[n("a",{attrs:{href:t.trainingSession.url,target:"training-session"}},[t._v(t._s(t.trainingSession.url))])])],1),t._v(" "),n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("Duration")])]),t._v(" "),n("column",{staticClass:"col-md-9"},[t._v("\n                        "+t._s(t.duration)+"\n                    ")])],1),t._v(" "),n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("Invite Message")])]),t._v(" "),n("column",{staticClass:"col-md-9",domProps:{innerHTML:t._s(t.trainingSession.invite_message)}})],1),t._v(" "),n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("Notes")])]),t._v(" "),n("column",{staticClass:"col-md-9"},[t._v(t._s(t.trainingSession.notes))])],1),t._v(" "),n("br"),t._v(" "),n("invite-email-preview",{attrs:{"training-session":t.trainingSession}})],1),t._v(" "),n("section",{staticClass:"mt-5",attrs:{id:"attendees"}},[n("attendees-manager",{attrs:{"training-session":t.trainingSession}})],1)])]),t._v(" "),n("b-modal",{attrs:{size:"lg","hide-footer":""},model:{value:t.showEdit,callback:function(e){t.showEdit=e},expression:"showEdit"}},[n("training-session-form",{attrs:{"training-session":t.trainingSession,errors:t.errors},on:{saved:t.updateSession,canceled:t.cancelUpdate}})],1),t._v(" "),n("b-modal",{attrs:{title:"How to add this training session to your calendar","hide-footer":""},model:{value:t.showCalendarHelp,callback:function(e){t.showCalendarHelp=e},expression:"showCalendarHelp"}},[n("b-modal-body",[n("dl",[n("dt",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-google",modifiers:{"collapse-google":!0}}],staticClass:"text-primary"},[n("h5",[t._v("Google, Yahoo, or web-based Outlook Calendar")])]),t._v(" "),n("dl",{staticClass:"pl-3"},[n("b-collapse",{attrs:{visible:"",id:"collapse-google"}},[t._v("\n                        Clicking on the link for your web-based calendar link will open your calendar in another tab/window and prompt your to save the event.\n                    ")])],1),t._v(" "),n("dt",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-apple-outlook",modifiers:{"collapse-apple-outlook":!0}}],staticClass:"text-primary"},[n("h5",[t._v("Apple or Outlook Calendar")])]),t._v(" "),n("dl",{staticClass:"pl-3"},[n("b-collapse",{attrs:{visible:"",id:"collapse-apple-outlook"}},[t._v("Clicking the link will download an .ics (iCalendar) standard file. Your operating system should open the file in the appropriate calendar application.")])],1),t._v(" "),n("dt",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-other",modifiers:{"collapse-other":!0}}],staticClass:"text-primary"},[n("h5",[t._v("Other calendar apps")])]),t._v(" "),n("dl",{staticClass:"pl-3"},[n("b-collapse",{attrs:{visible:"",id:"collapse-other"}},[t._v("\n                        Most calendar apps support the open iCalendar format so you should  download and open the .ics file by clicking on 'Apple & Outlook'\n                    ")])],1)])])],1)],1)}),[],!1,null,null,null);e.default=V.exports},SfO4:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"tr.table-muted{background-color:#ddd;color:999!important}",""])},"WL/6":function(t,e,n){"use strict";var s=n("wd/R"),i=n.n(s);e.a=function(t,e){return console.info("updateTrainingSession",e),e.starts_at=i()(e.starts_at).toISOString(),e.ends_at=i()(e.ends_at).toISOString(),window.axios.put("/api/training-sessions/"+t,e)}},cfPs:function(t,e,n){"use strict";var s=n("wd/R"),i=n.n(s),a=n("8w6g"),r={props:{value:{required:!0}},data:function(){return{dateValue:null,timeValue:null}},computed:{currentTimezone:function(){return"".concat(i()().tz(Intl.DateTimeFormat().resolvedOptions().timeZone).format("z")," (").concat(Intl.DateTimeFormat().resolvedOptions().timeZone,")")}},watch:{value:{immediate:!0,handler:function(t,e){this.syncDateAndTime()}},dateValue:function(){this.handleChange()},timeValue:function(){this.handleChange()}},methods:{handleChange:function(){var t=i()(this.dateValue+" "+this.timeValue,"YYYY-MM-DD HH:mm:ss A");this.$emit("input",t),this.$emit("change")},syncDateAndTime:function(){this.dateValue=i()(this.value).format("YYYY-MM-DD"),this.timeValue=i()(this.value).format("HH:mm")}}},o=n("KHd+"),l=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-input-group",{attrs:{append:t.currentTimezone}},[n("b-form-datepicker",{attrs:{"date-format-options":{year:"numeric",month:"numeric",day:"numeric"}},on:{change:t.handleChange},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}}),t._v(" "),n("b-form-timepicker",{on:{change:t.handleChange},model:{value:t.timeValue,callback:function(e){t.timeValue=e},expression:"timeValue"}})],1)}),[],!1,null,null,null).exports,c=n("IAky"),u=n("1Q+X"),d={components:{DateTime:l},props:{trainingSession:{type:Object,required:!1,default:function(){return new a.a}},errors:{type:Object,default:function(){}}},data:function(){return{topics:[{}],newSessionData:{},duration:60,durationMin:15,durationMax:240,durationErrors:[],newInviteMessage:""}},computed:{currentTimezone:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone}},methods:{updateEndsAt:function(){this.newSessionData.starts_at&&this.duration&&(this.newSessionData.ends_at=this.newSessionData.starts_at.clone().add(this.duration,"minutes"))},initNewSession:function(){null!==this.trainingSession&&this.syncTrainingSession()},syncTrainingSession:function(){this.newSessionData=this.trainingSession.attributes,this.duration=this.trainingSession.duration?this.trainingSession.duration:60},durationIsValid:function(){return!(this.duration<this.durationMin||this.duration>this.durationMax)||(this.durationErrors=["The session must be at least 15 minutes and no more than 240 minutes."],!1)},loadCurationActivities:function(){var t=this;this.topics=[],Object(c.a)().then((function(e){e.forEach((function(e){t.topics.push(e)}))})),Object(u.a)().then((function(e){e.forEach((function(e){t.topics.push(e)}))}))}},mounted:function(){this.initNewSession(),this.loadCurationActivities()}},v=Object(o.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"topic"}},[t._v("Topic *")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.newSessionData.topic_id,expression:"newSessionData.topic_id"}],staticClass:"form-control",attrs:{id:"topic"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.newSessionData,"topic_id",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""}},[t._v("Select…")]),t._v(" "),t._l(t.topics,(function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),t._v(" "),n("validation-error",{attrs:{errors:t.errors.topic_id}})],1)]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"start-date-field"}},[t._v("\n            Start Date & time*\n        ")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("date-time",{staticClass:"form-inline",on:{change:t.updateEndsAt},model:{value:t.newSessionData.starts_at,callback:function(e){t.$set(t.newSessionData,"starts_at",e)},expression:"newSessionData.starts_at"}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.starts_at}})],1)]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"duration-field"}},[t._v("Duration (in minutes)*")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.duration,expression:"duration"}],staticClass:"form-control",attrs:{type:"text",id:"duration-field"},domProps:{value:t.duration},on:{change:t.updateEndsAt,input:function(e){e.target.composing||(t.duration=e.target.value)}}}),t._v(" "),n("small",{staticClass:"text-muted"},[t._v("Ends "+t._s(t._f("formatDate")(this.newSessionData.ends_at,"YYYY-MM-DD hh:mm A")))]),t._v(" "),n("validation-error",{attrs:{errors:t.durationErrors}})],1)]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-sm-3",attrs:{for:"url-field"}},[t._v("URL*")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.newSessionData.url,expression:"newSessionData.url"}],staticClass:"form-control w-100",attrs:{type:"text",id:"url-field",placeholder:"https://zoom.com"},domProps:{value:t.newSessionData.url},on:{input:function(e){e.target.composing||t.$set(t.newSessionData,"url",e.target.value)}}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.url}})],1)]),t._v(" "),n("div",{staticClass:"form-group row align-items-start"},[n("label",{staticClass:"col-sm-3",attrs:{for:"invie-message-field"}},[t._v("Inivite Message")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("rich-text",{attrs:{id:"message-body"},model:{value:t.newSessionData.invite_message,callback:function(e){t.$set(t.newSessionData,"invite_message",e)},expression:"newSessionData.invite_message"}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.invite_message}})],1)]),t._v(" "),n("div",{staticClass:"form-group row align-items-start"},[n("label",{staticClass:"col-sm-3",attrs:{for:"notes-field"}},[t._v("Notes")]),t._v(" "),n("div",{staticClass:"col-sm-9"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newSessionData.notes,expression:"newSessionData.notes"}],staticClass:"form-control w-100",attrs:{id:"nots-field",rows:"5"},domProps:{value:t.newSessionData.notes},on:{input:function(e){e.target.composing||t.$set(t.newSessionData,"notes",e.target.value)}}}),t._v(" "),n("validation-error",{attrs:{errors:t.errors.notes}})],1)]),t._v(" "),n("div",[n("button",{staticClass:"btn btn-default border",on:{click:function(e){return t.$emit("canceled")}}},[t._v("\n            Cancel\n        ")]),t._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.$emit("saved",t.newSessionData)}}},[t._v("\n            Save\n        ")])])])}),[],!1,null,null,null);e.a=v.exports},kf0Z:function(t,e,n){"use strict";var s=n("opZA");n.n(s).a},opZA:function(t,e,n){var s=n("SfO4");"string"==typeof s&&(s=[[t.i,s,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(s,i);s.locals&&(t.exports=s.locals)},pQJT:function(t,e,n){"use strict";var s=n("wd/R"),i=n.n(s);e.a=function(t,e){var n={trained_at:i()(e).format("YYYY-MM-DD")};return window.axios.put("/api/trainings/"+t,n)}}}]);
//# sourceMappingURL=training-session-detail.fc39dcb7cc481715fe62.js.map