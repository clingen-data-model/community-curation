(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"5zh7":function(t,e,n){"use strict";e.a=function(t,e){return window.axios.put("/api/assignments/"+t,e)}},Ag4t:function(t,e,n){"use strict";var s=n("eLlm"),a=n("5zh7"),i={components:{AssignmentStatusInput:s.a},props:{variant:{type:String,default:"primary"},assignment:{type:Object,required:!0}},data:function(){return{savingUpdate:!1}},computed:{},methods:{handleAssignmentChange:function(t){var e=this;this.savingUpdate=!0,Object(a.a)(this.assignment.id,{assignment_status_id:t}).then((function(t){return e.$emit("assignmentsupdated"),t})).catch((function(t){return console.error(t)})).then((function(){e.savingUpdate=!1,e.$refs.statusPopover.$emit("close")}))}}},r=n("KHd+"),o=Object(r.a)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"d-inline-block",staticStyle:{width:"100px"}},[n("div",{staticClass:"badge badge-light border",attrs:{id:"assignment-status-badge-"+t.assignment.id}},[t._v("\n        "+t._s(t.assignment.status.name)+"\n        "),n("span",{staticClass:"text-muted"},[t._v("|")]),t._v(" "),n("i",{staticClass:"material-icons text-muted",staticStyle:{"font-size":"1em"}},[t._v("edit")])]),t._v(" "),n("b-popover",{ref:"statusPopover",attrs:{target:"assignment-status-badge-"+t.assignment.id,triggers:"hover focus"}},[n("small",[t._v("Set Status:")]),t._v(" "),t.savingUpdate?t._e():n("assignment-status-input",{attrs:{assignment:t.assignment},on:{assignmentstatuschange:t.handleAssignmentChange}}),t._v(" "),n("div",[t.savingUpdate?n("small",{staticClass:"text-muted"},[t._v("Saving status update...")]):t._e()])],1)],1)}),[],!1,null,null,null);e.a=o.exports},QuOj:function(t,e,n){"use strict";n.r(e);var s=n("o0o1"),a=n.n(s),i=n("WL/6"),r=n("cfPs"),o=n("wd/R"),l=n.n(o),c=function(t,e){return window.axios.post("/api/training-sessions/"+t.id+"/attendees",{attendee_ids:e.map((function(t){return t.id}))})},u=n("pQJT");function d(t,e,n,s,a,i,r){try{var o=t[i](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,a)}var m=function(){var t,e=(t=a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.axios.get("/api/training-sessions/"+e.id+"/attendees").then((function(t){return t.data.data})).catch((function(t){t.response?alert(t.response.statusText):alert("There was a problem getting attendees for training session ")}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,a){var i=t.apply(e,n);function r(t){d(i,s,a,r,o,"next",t)}function o(t){d(i,s,a,r,o,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}();function v(t,e,n,s,a,i,r){try{var o=t[i](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,a)}var f=function(){var t,e=(t=a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.axios.get("/api/training-sessions/"+e.id+"/trainable-volunteers").then((function(t){return t.data.data})).catch((function(t){alert(t.response.statusText)}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,a){var i=t.apply(e,n);function r(t){v(i,s,a,r,o,"next",t)}function o(t){v(i,s,a,r,o,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}(),p=n("L2JU");function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _={props:{trainingSession:{required:!0,type:Object},attendees:{required:!0,type:Array}},data:function(){return{subject:"",emailContent:"",fromEmail:this.$store.state.configs.mailFrom.address}},methods:h(h({},Object(p.d)("messages",["addInfo"])),{},{sendEmail:function(){var t=this;""!=this.emailContent?(this.$emit("sending"),window.axios.post("/api/training-sessions/"+this.trainingSession.id+"/attendees/email",{from:this.fromEmail,subject:this.subject,body:this.emailContent}).then((function(e){t.addInfo("Email sent"),t.initData(),t.$emit("sent")}))):alert("You must include a message to send to attendees.")},cancelEmail:function(){this.initData(),this.$emit("canceled")},initData:function(){this.subject="",this.emailContent=""}})},w=n("KHd+"),y=Object(w.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border p-3 rounded"},[n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-lg-1"},[t._v("To:")]),t._v(" "),n("small",{staticClass:"col-lg-11"},[t._v(t._s(t.attendees.map((function(t){return t.first_name+" "+t.last_name})).join(", ")))])]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-lg-1",attrs:{for:"from"}},[t._v("From:")]),t._v(" "),n("div",{staticClass:"col-lg-6"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.fromEmail,expression:"fromEmail"}],staticClass:"form-control",attrs:{id:"from"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.fromEmail=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:t.$store.state.configs.mailFrom.address}},[t._v(t._s(t.$store.state.configs.mailFrom.address))]),t._v(" "),n("option",{domProps:{value:t.$store.state.user.email}},[t._v(t._s(t.$store.state.user.email))])])])]),t._v(" "),n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-lg-1",attrs:{for:"subject"}},[t._v("Subject:")]),t._v(" "),n("div",{staticClass:"col-lg-8"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.subject,expression:"subject"}],staticClass:"form-control w-50",attrs:{type:"text",id:"subject"},domProps:{value:t.subject},on:{input:function(e){e.target.composing||(t.subject=e.target.value)}}})])]),t._v(" "),n("rich-text",{attrs:{id:"message-body"},model:{value:t.emailContent,callback:function(e){t.emailContent=e},expression:"emailContent"}}),t._v(" "),n("div",{staticClass:"mt-3"},[n("button",{staticClass:"btn btn-sm btn-default border",on:{click:t.cancelEmail}},[t._v("Cancel")]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-primary",on:{click:t.sendEmail}},[t._v("Send Email")])])],1)}),[],!1,null,null,null).exports,C=n("qjDQ"),S=n("Ag4t");var x=function(t){if(navigator.clipboard)return navigator.clipboard.writeText(t);!function(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{var n=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+n)}catch(t){console.error("Fallback: Oops, unable to copy",t)}document.body.removeChild(e)}(t)};function k(t,e,n,s,a,i,r){try{var o=t[i](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,a)}function O(t){return function(){var e=this,n=arguments;return new Promise((function(s,a){var i=t.apply(e,n);function r(t){k(i,s,a,r,o,"next",t)}function o(t){k(i,s,a,r,o,"throw",t)}r(void 0)}))}}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){T(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E={components:{AttendeeEmailForm:y,StatusBadge:S.a},props:{trainingSession:{required:!0,type:Object}},data:function(){var t=this;return{statusChange:0,currentVolunteer:{assignments:[]},test:!1,attendees:[],selectedVolunteers:[],fields:[{key:"first_name",label:"First Name",sortable:!0},{key:"last_name",label:"Last Name",sortable:!0},{key:"email",label:"Email",sortable:!0},{key:"assignments[0].date_assigned",label:"Date Assigned",sortable:!0,formatter:function(e,n,s){if(s.assignments[0])return t.$root.$options.filters.formatDate(s.assignments[0].date_assigned,"YYYY-MM-DD");console.info("missing assignments",s)}}],trainableVolunteers:[],loadingAttendees:!1,loadingVolunteers:!1,selectAll:!1,showEmailForm:!1,inviting:!1,currentDateTime:l()(),trainableFilter:null,showInactiveTrainables:!1,showUpdateStatus:!1}},watch:{trainingSession:function(){this.getAttendees(),this.getTrainableVolunteers()}},computed:{sessionStarted:function(){return this.trainingSession.starts_at.isBefore(this.currentDateTime)},hasAttendees:function(){return this.attendees.length>0},inviteFields:function(){return this.fields.concat([{key:"id",label:""},{key:"training_sessions_count",label:""}])},attendeeFields:function(){return this.fields.concat([{key:"id",label:""}])},canInvite:function(){return this.trainableVolunteers.length>0&&this.selectedVolunteers.length>0&&!this.inviting},inviteButtonText:function(){return this.inviting?"Busy...":"Invite Selected"},activeTrainable:function(){return this.showInactiveTrainables?this.trainableVolunteers:this.trainableVolunteers.filter((function(t){return!!t.assignments[0]&&-1==["unresponsive","declined","retired"].indexOf(t.assignments[0].status.name)}))},filteredTrainable:function(){var t=this;return null===this.trainableFilter||""===this.trainableFilter?this.activeTrainable:this.activeTrainable.filter((function(e){return e.first_name.toLowerCase().includes(t.trainableFilter.toLowerCase())||e.last_name.toLowerCase().includes(t.trainableFilter.toLowerCase())}))},previouslyInvited:function(){return this.filteredTrainable.filter((function(t){return t.training_sessions_count>0}))}},methods:j(j({},Object(p.d)("messages",["addInfo"])),{},{toggleAll:function(){this.selectAll?this.selectedVolunteers=this.activeTrainable:this.selectedVolunteers=[]},inviteSelected:function(){var t=this,e=JSON.parse(JSON.stringify(this.attendees)),n=JSON.parse(JSON.stringify(this.trainableVolunteers));this.inviting=!0,c(this.trainingSession,this.selectedVolunteers).then((function(e){t.attendees=e.data.data,t.addInfo("Invited "+t.selectedVolunteers.length+" volunteer"+(t.selectedVolunteers.length>1?"s":"")+" to the training session"),t.selectedVolunteers=[],t.getTrainableVolunteers(),t.selectAll=!1})).catch((function(s){alert("There was a problem inviting attendees: "+s.response.statusText+"."),t.attendees=e,t.trainableVolunteers=n,t.selectAll=!1})).then((function(){return t.inviting=!1}))},getSelectedEmails:function(){var t=this,e=this.selectedVolunteers.map((function(t){return t.email})).join(",");x(e).then((function(){t.addInfo("Email addresses for "+t.selectedVolunteers.length+" volunteers copied to your clipboard")}))},getAttendees:function(){var t=this;return O(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingAttendees=!0,e.next=3,m(t.trainingSession);case 3:t.attendees=e.sent,t.loadingAttendees=!1;case 5:case"end":return e.stop()}}),e)})))()},getTrainableVolunteers:function(){var t=this;return O(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingVolunteers=!0,e.next=3,f(t.trainingSession);case 3:t.trainableVolunteers=e.sent,t.trainableVolunteers=t.trainableVolunteers.map((function(t){return t.assignments[0]?(["unresponsive","declined","retired"].indexOf(t.assignments[0].status.name)>-1&&(t._rowVariant="muted"),t):t})),t.loadingVolunteers=!1;case 6:case"end":return e.stop()}}),e)})))()},handleInviteRowClick:function(t,e,n){var s=this.selectedVolunteers.indexOf(t);s>-1?this.selectedVolunteers.splice(s,1):this.selectedVolunteers.push(t)},markTrainingComplete:function(t){var e=this;this.$set(t,"training_complete",!0),Object(u.a)(t.assignments[0].user_aptitudes[0].id,l()()).then((function(n){e.addInfo("Training marked completed for "+t.first_name+" "+t.last_name)}))},markUnresponsive:function(t){var e=this;return O(a.a.mark((function n(){var s;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s="You are about to mark ".concat(t.name," unresponsive to their ").concat(e.trainingSession.topic.name," variant curation activity assignment.  If you continue and the volunteer does not have other assignments their volunteer-status will be set to unresponsive. Do you want to continue?"),!confirm(s)){n.next=5;break}return n.next=4,Object(C.a)(t.id,{});case 4:t=n.sent;case 5:case"end":return n.stop()}}),n)})))()}}),mounted:function(){var t=this;setInterval((function(){t.currentDateTime=l()()}),1e3)}},V=(n("kf0Z"),Object(w.a)(E,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("section",[n("header",[n("button",{staticClass:"btn btn-light border btn-xs float-right",on:{click:function(e){t.showEmailForm=!t.showEmailForm}}},[t._v("\n                "+t._s(t.showEmailForm?"Cancel email":"Email attendees")+"\n            ")]),t._v(" "),n("h4",[t._v("\n                Attendees "),n("small",[t._v("("+t._s(t.attendees.length)+")")]),t._v(" "),n("button",{staticClass:"btn btn-default material-icons",class:{rotate:t.loadingAttendees},on:{click:t.getAttendees}},[t._v("cached")])])]),t._v(" "),n("transition",{attrs:{name:"slide-fade"}},[n("attendee-email-form",{directives:[{name:"show",rawName:"v-show",value:t.showEmailForm,expression:"showEmailForm"}],staticClass:"mb-2",attrs:{trainingSession:t.trainingSession,attendees:t.attendees},on:{sending:function(e){t.showEmailForm=!1},sent:function(e){t.showEmailForm=!1},canceled:function(e){t.showEmailForm=!1}}})],1),t._v(" "),n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEmailForm,expression:"!showEmailForm"}]},[t.hasAttendees?n("div",{staticStyle:{"overflow-y":"scroll","border-bottom":"1px solid #eee"}},[n("b-table",{staticClass:"border-bottom",attrs:{fields:t.attendeeFields,items:t.attendees,small:"","sticky-header":"305px","no-border-collapse":""},scopedSlots:t._u([{key:"cell(first_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.first_name))])]}},{key:"cell(last_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.last_name))])]}},{key:"cell(id)",fn:function(e){var s=e.item;return[t.sessionStarted&&!s.training_complete?n("button",{staticClass:"btn btn-default btn-xs border",on:{click:function(e){return t.markTrainingComplete(s)}}},[t._v("\n                                Mark Training Complete\n                            ")]):t._e(),t._v(" "),n("small",{directives:[{name:"show",rawName:"v-show",value:s.training_complete,expression:"item.training_complete"}],staticClass:"text-muted"},[t._v("Training Complete")])]}}],null,!1,966640674)})],1):n("div",{staticClass:"alert alert-light border"},[t.loadingAttendees?n("span",[t._v("Loading...")]):n("span",[t._v("No volunteers have been invited to attend.")])])])])],1),t._v(" "),n("section",{staticClass:"mt-5"},[n("header",{staticClass:"clearfix"},[n("button",{staticClass:"btn btn-sm btn-light border float-right ml-2",attrs:{disabled:!t.canInvite},on:{click:t.getSelectedEmails}},[t._v("Copy emails")]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-primary float-right",attrs:{disabled:!t.canInvite},on:{click:t.inviteSelected}},[t._v(t._s(t.inviteButtonText))]),t._v(" "),n("div",{staticClass:"float-right mr-2 mb-2 pr-2 border-right"},[n("b-form-input",{staticClass:"form-control form-control-sm mr-1",attrs:{type:"text",placeholder:"search first or last",debounce:"250"},model:{value:t.trainableFilter,callback:function(e){t.trainableFilter=e},expression:"trainableFilter"}}),t._v(" "),n("button",{staticClass:"btn btn-xs btn-default",on:{click:function(e){t.showInactiveTrainables=!t.showInactiveTrainables}}},[t._v("\n                    "+t._s(t.showInactiveTrainables?"Hide":"Show")+" inactive volunteers\n                ")])],1),t._v(" "),n("h5",[t._v("\n                "+t._s(t.showInactiveTrainables?"All":"Active")+" volunteers who need "+t._s(t.trainingSession.topic.name)+" training \n                "),n("small",[t._v("("+t._s(t.filteredTrainable.length)+")")]),t._v(" "),n("button",{staticClass:"btn btn-default material-icons",class:{rotate:t.loadingVolunteers},on:{click:t.getTrainableVolunteers}},[t._v("cached")])])]),t._v(" "),t.trainableVolunteers.length>0?n("b-table",{staticClass:"border-bottom",attrs:{fields:t.inviteFields,items:t.filteredTrainable,"sort-by":"assignments[0].date_assigned",small:"","no-border-collapse":""},on:{"row-clicked":t.handleInviteRowClick},scopedSlots:t._u([{key:"cell(first_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.first_name))])]}},{key:"cell(last_name)",fn:function(e){var s=e.item;return[n("a",{attrs:{href:"/volunteers/"+s.id}},[t._v(t._s(s.last_name))])]}},{key:"cell(id)",fn:function(e){var s=e.item;return[n("div",{staticClass:"text-center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedVolunteers,expression:"selectedVolunteers"}],attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selectedVolunteers)?t._i(t.selectedVolunteers,s)>-1:t.selectedVolunteers},on:{change:function(e){var n=t.selectedVolunteers,a=e.target,i=!!a.checked;if(Array.isArray(n)){var r=s,o=t._i(n,r);a.checked?o<0&&(t.selectedVolunteers=n.concat([r])):o>-1&&(t.selectedVolunteers=n.slice(0,o).concat(n.slice(o+1)))}else t.selectedVolunteers=i}}})])]}},{key:"cell(training_sessions_count)",fn:function(e){var s=e.item;return[s.training_sessions_count>0?n("div",{attrs:{id:"attendence-warning-"+s.id}},[n("b-icon",{staticClass:"cursor-pointer",staticStyle:{color:"#ffc107!important"},attrs:{icon:"exclamation-triangle-fill"},on:{click:function(e){e.stopPropagation(),t.showUpdateStatus=!0,t.currentVolunteer=s}}}),t._v(" "),n("b-popover",{attrs:{target:"attendence-warning-"+s.id,triggers:"hover"}},[t._v("\n                        "+t._s(s.training_sessions_count)+" previous\n                        invite"+t._s(s.training_sessions_count>1?"s":"")+" \n                        to "+t._s(t.trainingSession.topic.name.toLowerCase())+" training\n                    ")])],1):t._e()]}},{key:"head(id)",fn:function(e){return[n("div",{staticClass:"text-center"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.selectAll,expression:"selectAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.selectAll)?t._i(t.selectAll,null)>-1:t.selectAll},on:{change:[function(e){var n=t.selectAll,s=e.target,a=!!s.checked;if(Array.isArray(n)){var i=t._i(n,null);s.checked?i<0&&(t.selectAll=n.concat([null])):i>-1&&(t.selectAll=n.slice(0,i).concat(n.slice(i+1)))}else t.selectAll=a},t.toggleAll]}})])]}}],null,!1,1787750591)}):n("div",{staticClass:"alert alert-light border mt-2 mb-2"},[t.loadingVolunteers?n("span",[t._v("Loading...")]):n("span",[t._v("There are no more volunteers who need this training at this time.")])]),t._v(" "),n("footer",{staticClass:"mt-1"},[n("button",{staticClass:"btn btn-sm btn-light border float-right ml-2",attrs:{disabled:!t.canInvite},on:{click:t.getSelectedEmails}},[t._v("Copy emails")]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-primary float-right",attrs:{disabled:!t.canInvite},on:{click:t.inviteSelected}},[t._v(t._s(t.inviteButtonText))])])],1),t._v(" "),n("b-modal",{attrs:{title:"Update Volunteer Statuses"},model:{value:t.showUpdateStatus,callback:function(e){t.showUpdateStatus=e},expression:"showUpdateStatus"}},[n("table",{staticClass:"table table-striped table-sm"},[n("tr",[n("th",[t._v("Name")]),t._v(" "),n("th",[t._v("Date Assigned")]),t._v(" "),n("th",[t._v("Invite #")]),t._v(" "),n("th",[t._v("\n                    Status\n                ")])]),t._v(" "),t._l(t.previouslyInvited,(function(e){return n("tr",{key:e.id},[n("td",[t._v(t._s(e.name))]),t._v(" "),n("td",[t._v(t._s(t._f("formatDate")(e.assignments[0].date_assigned,"YYYY-MM-DD")))]),t._v(" "),n("td",[t._v(t._s(e.training_sessions_count))]),t._v(" "),n("td",[n("status-badge",{attrs:{assignment:e.assignments[0]},on:{assignmentsupdated:t.getTrainableVolunteers}})],1)])}))],2)])],1)}),[],!1,null,null,null).exports),P=n("PZa2"),I=n("8w6g");function F(t,e,n,s,a,i,r){try{var o=t[i](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,a)}var D={components:{TrainingSessionForm:r.a,AttendeesManager:V,InviteEmailPreview:P.a},props:{id:{required:!0,type:Number}},data:function(){return{trainingSession:{topic:{}},showEdit:!1,errors:{},show404:!1,showCalendarHelp:!1,showEmailPreview:!1,started:!1,ended:!1,timestamp:(new Date).getTime(),loading:!1}},computed:{duration:function(){if(!this.trainingSession.starts_at||!this.trainingSession.ends_at)return"";var t=this.trainingSession.ends_at.diff(this.trainingSession.starts_at,"minutes");if(t>60){var e=Math.floor(t/60),n=t%60,s=[e];return s.push(e>1?"hours":"hour"),s.push(n),s.push(n>1?"minutes":"minute"),s.join(" ")}return"".concat(t," minutes")}},methods:{updateSession:function(t){var e=this;this.errors={},Object(i.a)(this.trainingSession.id,t).then((function(t){e.showEdit=!1;var n=new I.a(t.data.data);n.starts_at=l()(n.starts_at),n.ends_at=l()(n.ends_at),e.trainingSession=n})).catch((function(t){t.response&&422==t.response.status&&(e.errors=t.response.data.errors),console.error(t)}))},cancelUpdate:function(){this.errors={},this.currentSession={},this.showEdit=!1},addToCalendar:function(){alert("add to calendar")},getTrainingSession:function(){var t,e=this;return(t=a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.show404=!1,e.loading=!0,t.next=4,window.axios.get("/api/training-sessions/"+e.id).then((function(t){return new I.a(t.data.data)})).catch((function(t){t.response&&404==t.response.status?e.show404=!0:new Error(t)}));case 4:e.trainingSession=t.sent,e.loading=!1,setInterval((function(){e.started=e.trainingSession.started,e.ended=e.trainingSession.ended,e.timestamp=(new Date).getTime()}),1e3);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,a){var i=t.apply(e,n);function r(t){F(i,s,a,r,o,"next",t)}function o(t){F(i,s,a,r,o,"throw",t)}r(void 0)}))})()}},mounted:function(){this.getTrainingSession()}},N=Object(w.a)(D,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"d-flex justify-content-between alert alert-info"},[t._v("\n        We've added a video showing you how to use this page: \n        "),n("screen-info",{attrs:{"video-url":"https://www.youtube.com/embed/WFFd6f-KaJA",title:"Learn about Training Sessions"}})],1),t._v(" "),n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("div",{staticClass:"float-right"},[n("b-dropdown",{attrs:{size:"sm",text:"Add to Calendar",variant:"primary",disabled:t.loading}},[t._l(t.trainingSession.calendar_links,(function(e,s){return n("b-dropdown-item",{key:s,attrs:{href:e,target:"calendar-link"}},[t._v(t._s(s))])})),t._v(" "),n("b-dropdown-divider"),t._v(" "),n("b-dropdown-item",{on:{click:function(e){t.showCalendarHelp=!0}}},[n("small",[t._v("Learn More")])])],2),t._v(" "),n("button",{staticClass:"btn btn-sm btn-primary",attrs:{disabled:t.loading},on:{click:function(e){t.showEdit=!0}}},[t._v("Edit")])],1),t._v(" "),n("h3",{staticClass:"m-0"},[n("a",{attrs:{href:"/training-sessions"}},[t._v("Training Sessions")]),t._v("\n                -\n                "),t.loading?n("span",[t._v("Loading...")]):n("span",[t._v("\n                    "+t._s(t.trainingSession.topic.name)+"\n                    on\n                    "+t._s(t._f("formatDate")(t.trainingSession.starts_at,"YYYY-MM-DD \\at h:mm a"))+"\n                ")])])]),t._v(" "),n("div",{staticClass:"card-body"},[t.trainingSession.started&&!t.trainingSession.ended?n("div",{key:t.timestamp,staticClass:"alert alert-success mt-0 mb-2"},[t._v("This session has started.")]):t._e(),t._v(" "),t.trainingSession.ended?n("div",{key:t.timestamp+1,staticClass:"alert alert-info mt-0 mb-2"},[t._v("This session has already happened.")]):t._e(),t._v(" "),t.show404?n("div",{staticClass:"alert alert-warning"},[t._v("\n                The session you're looking for could not be found.\n            ")]):t._e(),t._v(" "),n("section",{attrs:{id:"session-info"}},[n("h4",[t._v("Session Info")]),t._v(" "),t.loading?n("div",[t._v("Loading...")]):t._e(),t._v(" "),t.loading?t._e():n("div",[n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("URL")])]),t._v(" "),n("column",{staticClass:"col-md-9"},[n("a",{attrs:{href:t.trainingSession.url,target:"training-session"}},[t._v(t._s(t.trainingSession.url))])])],1),t._v(" "),n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("Duration")])]),t._v(" "),n("column",{staticClass:"col-md-9"},[t._v("\n                            "+t._s(t.duration)+"\n                        ")])],1),t._v(" "),n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("Invite Message")])]),t._v(" "),n("column",{staticClass:"col-md-9",domProps:{innerHTML:t._s(t.trainingSession.invite_message)}})],1),t._v(" "),n("row",{staticClass:"mb-2"},[n("column",{staticClass:"col-md-2 text-right"},[n("strong",[t._v("Notes")])]),t._v(" "),n("column",{staticClass:"col-md-9"},[t._v(t._s(t.trainingSession.notes))])],1),t._v(" "),n("invite-email-preview",{attrs:{"training-session":t.trainingSession}})],1),t._v(" "),n("br")]),t._v(" "),n("section",{staticClass:"mt-5",attrs:{id:"attendees"}},[n("attendees-manager",{attrs:{"training-session":t.trainingSession}})],1)])]),t._v(" "),n("b-modal",{attrs:{size:"lg","hide-footer":""},model:{value:t.showEdit,callback:function(e){t.showEdit=e},expression:"showEdit"}},[n("training-session-form",{attrs:{"training-session":t.trainingSession,errors:t.errors},on:{saved:t.updateSession,canceled:t.cancelUpdate}})],1),t._v(" "),n("b-modal",{attrs:{title:"How to add this training session to your calendar","hide-footer":""},model:{value:t.showCalendarHelp,callback:function(e){t.showCalendarHelp=e},expression:"showCalendarHelp"}},[n("b-modal-body",[n("dl",[n("dt",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-google",modifiers:{"collapse-google":!0}}],staticClass:"text-primary"},[n("h5",[t._v("Google, Yahoo, or web-based Outlook Calendar")])]),t._v(" "),n("dl",{staticClass:"pl-3"},[n("b-collapse",{attrs:{visible:"",id:"collapse-google"}},[t._v("\n                        Clicking on the link for your web-based calendar link will open your calendar in another tab/window and prompt your to save the event.\n                    ")])],1),t._v(" "),n("dt",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-apple-outlook",modifiers:{"collapse-apple-outlook":!0}}],staticClass:"text-primary"},[n("h5",[t._v("Apple or Outlook Calendar")])]),t._v(" "),n("dl",{staticClass:"pl-3"},[n("b-collapse",{attrs:{visible:"",id:"collapse-apple-outlook"}},[t._v("Clicking the link will download an .ics (iCalendar) standard file. Your operating system should open the file in the appropriate calendar application.")])],1),t._v(" "),n("dt",{directives:[{name:"b-toggle",rawName:"v-b-toggle.collapse-other",modifiers:{"collapse-other":!0}}],staticClass:"text-primary"},[n("h5",[t._v("Other calendar apps")])]),t._v(" "),n("dl",{staticClass:"pl-3"},[n("b-collapse",{attrs:{visible:"",id:"collapse-other"}},[t._v("\n                        Most calendar apps support the open iCalendar format so you should  download and open the .ics file by clicking on 'Apple & Outlook'\n                    ")])],1)])])],1)],1)}),[],!1,null,null,null);e.default=N.exports},SfO4:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"tr.table-muted{background-color:#ddd;color:999!important}",""])},eLlm:function(t,e,n){"use strict";var s=n("o0o1"),a=n.n(s);function i(t,e,n,s,a,i,r){try{var o=t[i](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,a)}var r=function(){var t,e=(t=a.a.mark((function t(){var e;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=JSON.parse(localStorage.getItem("assignment-statuses"))){t.next=5;break}return t.next=4,window.axios.get("/api/assignment-statuses").then((function(t){return localStorage.setItem("assignment-statuses",JSON.stringify(t.data.data)),t.data.data}));case 4:e=t.sent;case 5:return t.abrupt("return",e);case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,a){var r=t.apply(e,n);function o(t){i(r,s,a,o,l,"next",t)}function l(t){i(r,s,a,o,l,"throw",t)}o(void 0)}))});return function(){return e.apply(this,arguments)}}();function o(t,e,n,s,a,i,r){try{var o=t[i](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(s,a)}var l,c,u={components:{},props:{assignment:{required:!0,type:Object}},data:function(){return{assignmentStatuses:[]}},computed:{newAssignmentStatusId:{get:function(){return this.assignment.status.id},set:function(t){this.$emit("assignmentstatuschange",t)}}},methods:{fetchAssignmentStatuses:(l=a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r();case 2:this.assignmentStatuses=t.sent;case 3:case"end":return t.stop()}}),t,this)})),c=function(){var t=this,e=arguments;return new Promise((function(n,s){var a=l.apply(t,e);function i(t){o(a,n,s,i,r,"next",t)}function r(t){o(a,n,s,i,r,"throw",t)}i(void 0)}))},function(){return c.apply(this,arguments)})},mounted:function(){this.fetchAssignmentStatuses()}},d=n("KHd+"),m=Object(d.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.newAssignmentStatusId,expression:"newAssignmentStatusId"}],staticClass:"form-control form-control-sm",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.newAssignmentStatusId=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:null}},[t._v("Select")]),t._v(" "),t._l(t.assignmentStatuses,(function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n        ")])}))],2)])}),[],!1,null,null,null);e.a=m.exports},kf0Z:function(t,e,n){"use strict";var s=n("opZA");n.n(s).a},opZA:function(t,e,n){var s=n("SfO4");"string"==typeof s&&(s=[[t.i,s,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(s,a);s.locals&&(t.exports=s.locals)},pQJT:function(t,e,n){"use strict";var s=n("wd/R"),a=n.n(s);e.a=function(t,e){var n={trained_at:a()(e).format("YYYY-MM-DD")};return window.axios.put("/api/trainings/"+t,n)}},qjDQ:function(t,e,n){"use strict";e.a=function(t,e){return window.axios.put("/api/volunteers/"+t,e)}}}]);
//# sourceMappingURL=training-session-detail.b43d494f205290949082.js.map