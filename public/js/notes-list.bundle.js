(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{"16LW":function(t,e,n){"use strict";n.r(e);var o=n("o0o1"),i=n.n(o),a=n("1Iqk"),r="/api/notes";var s={props:{note:{type:Object,required:!1,default:function(){}},notableType:{type:String,required:!0},notableId:{type:Number,required:!0}},data:function(){return{noteCopy:{},notabletypes:[{id:"App\\User",label:"Volunteer"},{id:"App\\CurationGroup",label:"Curation group"}]}},computed:{},watch:{note:{immediate:!0,handler:function(){this.noteCopy=JSON.parse(JSON.stringify(this.note))}},notableType:{immediate:!0,handler:function(){this.$set(this.noteCopy,"notable_type",this.notableType)}},notableId:{immediate:!0,handler:function(){this.$set(this.noteCopy,"notable_id",this.notableId)}}},methods:{cancel:function(){this.noteCopy={},this.$emit("canceled")},saveNote:function(){var t,e,n=this;this.noteCopy.id?(t=this.noteCopy.id,e=this.noteCopy,window.axios.put("".concat(r,"/").concat(t),e)).then((function(t){n.noteCopy={notable_type:n.notableType,notable_id:n.notableId},n.$emit("saved",t.data.data)})):function(t){return window.axios.post(r,t)}(this.noteCopy).then((function(t){n.noteCopy={notable_type:n.notableType,notable_id:n.notableId},n.$emit("saved",t.data.data)}))}}},c=n("KHd+");function l(t,e,n,o,i,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,i)}var d={components:{NoteForm:Object(c.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.noteCopy.content,expression:"noteCopy.content"}],staticClass:"form-control mb-2",attrs:{cols:"30",rows:"10"},domProps:{value:t.noteCopy.content},on:{input:function(e){e.target.composing||t.$set(t.noteCopy,"content",e.target.value)}}}),t._v(" "),n("button",{staticClass:"btn btn-light border",on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:t.saveNote}},[t._v("Save")])])}),[],!1,null,null,null).exports},props:{initialNotes:{type:Array,required:!1,default:function(){return[]}},notableType:{type:String,required:!0},notableId:{type:Number,required:!0}},data:function(){return{notes:[],loading:!1,showingCreateForm:!1,currentNote:null}},watch:{initialNotes:{immediate:!0,handler:function(){this.notes=this.initialNotes}},lookupParams:function(){this.getNotes()}},computed:{},methods:{getNotes:function(){var t,e=this;return(t=i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,(n={notable_type:e.notableType,notable_id:e.notableId,with:["creator"]},window.axios.get("".concat(r,"?").concat(Object(a.a)(n)))).then((function(t){return t.data.data}));case 3:e.notes=t.sent,e.loading=!1;case 5:case"end":return t.stop()}var n}),t)})),function(){var e=this,n=arguments;return new Promise((function(o,i){var a=t.apply(e,n);function r(t){l(a,o,i,r,s,"next",t)}function s(t){l(a,o,i,r,s,"throw",t)}r(void 0)}))})()},showCreateForm:function(){this.currentNote={},this.showingCreateForm=!0},editNote:function(t){this.currentNote=t,this.showingCreateForm=!0},updateNotes:function(t){var e=this.notes.findIndex((function(e){return e.id==t.id}));if(e>-1)return this.notes[e]=t,void(this.showingCreateForm=!1);this.notes.push(t),this.showingCreateForm=!1},deleteNote:function(t){var e=this;if(confirm("You are about to delete a note.  Are you sure you want to continue?")){var n=this.notes.findIndex((function(e){return e.id==t.id}));(function(t){return window.axios.delete("".concat(r,"/").concat(t.id))})(t).then((function(t){e.notes.splice(n,1)}))}}},mounted:function(){0==this.notes.length&&this.getNotes()}},u=Object(c.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"clearfix"},[n("button",{staticClass:"btn btn-sm btn-primary float-right",on:{click:t.showCreateForm}},[t._v("Add note")])]),t._v(" "),n("div",{staticClass:"mt-2"},[t.notes.length>0?n("ul",{staticClass:"list-unstyled"},t._l(t.notes,(function(e){return n("li",{key:e.id,staticClass:"mb-2"},[n("b-card",[n("div",{staticClass:"float-right ml-3"},[n("button",{staticClass:"btn btn-default border btn-sm",on:{click:function(n){return t.editNote(e)}}},[n("b-icon-pencil")],1),t._v(" "),n("button",{staticClass:"btn btn-default border btn-sm",on:{click:function(n){return t.deleteNote(e)}}},[n("b-icon-trash")],1)]),t._v(" "),n("p",{staticClass:"lead"},[t._v(t._s(e.content))]),t._v("\n                    created on "+t._s(t._f("formatDate")(e.created_at,"YYYY-MM-DD hh:mm a"))+" by "+t._s(e.creator.name)+"\n                ")])],1)})),0):t.loading?n("div",{staticClass:"alert alert-light border text-center"},[t._v("Loading notes...")]):n("div",{staticClass:"alert alert-light border text-center"},[t._v("\n            There not any notes for this entry. "),n("button",{staticClass:"btn btn-link",on:{click:t.showCreateForm}},[t._v("Add one")])])]),t._v(" "),n("b-modal",{attrs:{title:"Add a new note","hide-footer":""},model:{value:t.showingCreateForm,callback:function(e){t.showingCreateForm=e},expression:"showingCreateForm"}},[n("note-form",{attrs:{note:t.currentNote,"notable-type":t.notableType,"notable-id":t.notableId},on:{canceled:function(e){t.showingCreateForm=!1},saved:t.updateNotes}})],1)],1)}),[],!1,null,null,null);e.default=u.exports},"KHd+":function(t,e,n){"use strict";function o(t,e,n,o,i,a,r,s){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),o&&(l.functional=!0),a&&(l._scopeId="data-v-"+a),r?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=c):i&&(c=s?function(){i.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(t,e){return c.call(e),d(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:l}}n.d(e,"a",(function(){return o}))}}]);
//# sourceMappingURL=notes-list.bundle.js.map